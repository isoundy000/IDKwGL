<!DOCTYPE html>

<html>
	<head>
		<title>Projeto CV</title>
		<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
		<style>
			#canvas
			{
				position: absolute; 
				top: 0px;
				left: 0px;
			}
		</style>

		<!--..........................................Shaders..........................................-->
		<script id="shader-vertex-color" type="x-shader/x-vertex">
		    attribute vec3 aVertexPosition;
		    attribute vec3 aVertexColor;
		    uniform mat4 uMVMatrix;
		    uniform mat4 uPMatrix;
		    varying vec4 vertexColor;

		    void main(void)
		    {
		        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
		        vertexColor = vec4(aVertexColor, 1.0);
		    }
		</script>

		<script id="shader-fragment-color" type="x-shader/x-fragment">
			precision mediump float;
			varying vec4 vertexColor;

			void main(void)
			{
				gl_FragColor = vertexColor;
			}
		</script>

		<script id="shader-vertex-texture" type="x-shader/x-vertex">
			attribute vec3 aVertexPosition;
			attribute vec2 aTextureCoord;
			uniform mat4 uMVMatrix;
			uniform mat4 uPMatrix;
			varying vec2 vTextureCoord;

			void main(void)
			{
				gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
				vTextureCoord = aTextureCoord;
			}
		</script>

		<script id="shader-fragment-texture" type="x-shader/x-fragment">
		    precision mediump float;
		    varying vec2 vTextureCoord;
		    uniform sampler2D uSampler;

		    void main(void)
		    {
		        gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
		    }
		</script>

		<script id="shader-vertex-light" type="x-shader/x-vertex">
			attribute vec3 aVertexPosition;
			attribute vec2 aTextureCoord;
			attribute vec3 aVertexNormal;

			uniform mat4 uMVMatrix;
			uniform mat4 uPMatrix;
			uniform mat3 uNMatrix;

			uniform vec3 uAmbientColor;
			uniform vec3 uPointLightingLocation;
			uniform vec3 uPointLightingColor;
			uniform bool uUseLighting;

			varying vec2 vTextureCoord;
			varying vec3 vLightWeighting;

			void main(void)
			{
				vec4 mvPosition = uMVMatrix * vec4(aVertexPosition, 1.0);
				gl_Position = uPMatrix * mvPosition;
				vTextureCoord = aTextureCoord;

				if (!uUseLighting)
				{
					vLightWeighting = vec3(1.0, 1.0, 1.0);
				}
				else
				{
					vec3 lightDirection = normalize(uPointLightingLocation - mvPosition.xyz);
					vec3 transformedNormal = uNMatrix * aVertexNormal;
					float directionalLightWeighting = max(dot(transformedNormal, lightDirection), 0.0);
					vLightWeighting = uAmbientColor + uPointLightingColor * directionalLightWeighting;
				}
			}
		</script>

		<script id="shader-fragment-light" type="x-shader/x-fragment">
			precision mediump float;

			varying vec2 vTextureCoord;
			varying vec3 vLightWeighting;

			uniform sampler2D uSampler;

			void main(void)
			{
				vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
				gl_FragColor = vec4(textureColor.rgb * vLightWeighting, textureColor.a);
			}
		</script>
		<!--...........................................................................................-->
		
		<script type="text/javascript" src="App.js"></script>
	</head>

	<body onload="App.initialize();" onresize="App.resize();" onkeypress="App.setFullscreen(event);">
		<div>
			<canvas id="canvas"/>
		</div>
	</body>
</html>
